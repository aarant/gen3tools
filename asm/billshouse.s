.text
.syntax unified
.thumb
.include "event.inc"

@ Map & Script data for Bill's House v1

.macro object_event index:req, gfx:req, replacement:req, x:req, y:req, elevation:req, movement_type:req, x_radius:req, y_radius:req, trainer_type:req, sight_radius_tree_etc:req, script:req, event_flag:req
.byte \index, \gfx, \replacement, 0
.2byte \x
.2byte \y
.byte \elevation, \movement_type, ((\y_radius << 4) | \x_radius), 0
  .2byte \trainer_type, \sight_radius_tree_etc
.4byte \script
.2byte \event_flag
.2byte 0
.endm

.equ Common_Movement_ExclamationMark, 0x0824361b
.equ VAR_TEMP_0, 0x4000
.equ walk_down, 8
.equ walk_up, 9
.equ walk_left, 10
.equ walk_right, 11
.equ step_end, 0xfe
.equ face_up, 1
.equ face_right, 3
.equ face_left, 2
.equ face_down, 0
.equ NULL, 0
.equ emote_exclamation_mark, 0x56
.equ emote_question_mark, 0x57
.equ delay_16, 0x14
.equ ForceReload, 0x08089598+1

mapHeader: @ 0203d000
  .4byte mapLayout @ layout
  .4byte mapEvents @ events
  .4byte mapScripts @ scripts
  .4byte 0 @ connections
  .2byte 0x0208 @ music; unused, since it is loaded based on group & number
  .2byte 0x0079 @ layoutId; TODO: What is this used for?
  .byte 0x1D @ region map section
  .byte 0 @ cave
  .byte 0 @ weather
  .byte 8 @ map type; unused and loaded based on group & num
  .space 2
  .byte 0 @ flags
  .byte 0 @ battleType
  .2byte 10 @ x
  .2byte 4 @ y
mapLayout:
  .4byte 15 @ width
  .4byte 11 @ height
  .4byte border @ border
  .4byte map @ map
  .4byte 0x083b7ca4 @ tileset1
  .4byte tileset2 @ tileset2
tileset2:
  .byte 1 @ isCompressed
  .byte 1 @ isSecondary
  .space 2
  .4byte tiles @ tiles
  .4byte palettes-0xc0 @ palettes
  .4byte metatiles @ metatiles
  .4byte attributes @ metatile attributes
  .4byte 0 @ callback
palettes:
  .incbin "maps/billshouse/06.gbapal"
  .incbin "maps/billshouse/07.gbapal"
  .incbin "maps/billshouse/08.gbapal"
  .incbin "maps/billshouse/09.gbapal"
metatiles:  .incbin "maps/billshouse/metatiles.bin"
attributes: .incbin "maps/billshouse/metatile_attributes.bin"
tiles:      .incbin "maps/billshouse/tiles.4bpp.lz"
border:     .incbin "maps/billshouse/border.bin"
map:        .incbin "maps/billshouse/map.bin"
.align 2
mapEvents:
  .byte 2 @ event object count
  .byte 0 @ warp count
  .byte 0 @ coordEventCount
  .byte 0 @ bgEventCount
  .4byte eventObjects @ eventObjects
  .4byte 0 @ warps
  .4byte 0 @ coordEvents
  .4byte 0 @ bgEvents
eventObjects:
  object_event 1, 20, 0, 4, 6, 3, 7, 0, 0, 0, 0, NULL, 0
  object_event 2, 231, 0, 3, 4, 3, 8, 0, 0, 0, 0, NULL, 0
mapScripts:
  .byte 2 @ frame table
  .4byte frameTable
  .byte 1 @ on transition
  .4byte Script_OnTransition
  .byte 0
Script_OnTransition:
  playse 4
  waitse
  waitse
  end
frameTable:
  .2byte VAR_TEMP_0, 0
  .4byte Script_OnEnter
  .2byte 0
Script_OnEnter:
  lockall
  setvar VAR_TEMP_0, 1
  playse 21 @ PIN
  applymovement 1, Common_Movement_ExclamationMark
  waitmovement 0
  delay 48
  turnobject 1, 4
  msgbox Text1
  closemessage
  applymovement 1, Movement1
  applymovement 2, Movement2
  waitmovement 1
  turnobject 0xff, 3
  msgbox Text2
  turnobject 1, 3
  msgbox Text3
  applymovement 1, Movement3
  waitmovement 1
  msgbox Text4
  closemessage
  applymovement 1, Movement4
  applymovement 2, Movement5
  applymovement 0xff, Movement5
  waitmovement 1
  msgbox Text5
  closemessage
  fadenewbgm 377
  delay 90
  setmetatile 3, 3, 0x200, 1
  setmetatile 3, 2, 0x234, 1
  setmetatile 10, 3, 0x200, 1
  setmetatile 10, 2, 0x234, 1
  callnative ForceReload
  playse 8
  delay 60
  applymovement 2, Movement6
  applymovement 0xff, Movement6
  waitmovement 2
  setmetatile 3, 3, 0x233, 1
  setmetatile 3, 2, 0x212, 1
  setmetatile 10, 3, 0x233, 1
  setmetatile 10, 2, 0x212, 1
  callnative ForceReload
  playse 248
  delay 60
  fadescreen 3
  playse 181
  waitse
  fadescreen 2
  applymovement 1, Common_Movement_ExclamationMark
  fadescreen 3
  playse 138
  waitse
  msgbox Text6
  closemessage
  playse 153
  waitse
  playbgm 0, 0
  playse 103
  delay 300
  playbgm 490, 0
  releaseall
  end
Text1:
  .byte 0xC9, 0xDC, 0x00, 0xD8, 0xD9, 0xD5, 0xE6, 0xB8, 0xB8, 0xFF
Movement1:
  .byte walk_right, walk_right, walk_right, walk_up, walk_up, face_right, delay_16, delay_16, face_left, delay_16
  .byte delay_16, face_right, step_end
Movement2:
  .byte face_right, emote_question_mark, step_end
Text2:
  .byte 0xCD, 0xE3, 0xE1, 0xD9, 0xE8, 0xDC, 0xDD, 0xE2, 0xDB, 0x00, 0xE7, 0xD9, 0xD9, 0xE1, 0xE7, 0x00
  .byte 0xE8, 0xE3, 0xFE, 0xDC, 0xD5, 0xEA, 0xD9, 0x00, 0xDB, 0xE3, 0xE2, 0xD9, 0x00, 0xEB, 0xE6, 0xE3
  .byte 0xE2, 0xDB, 0xB8, 0xFA, 0xD1, 0xDC, 0xE3, 0x00, 0xD5, 0xE6, 0xD9, 0x00, 0xED, 0xE3, 0xE9, 0xAC
  .byte 0xFB, 0xBB, 0xE2, 0xD8, 0x00, 0xDC, 0xE3, 0xEB, 0x00, 0xD8, 0xDD, 0xD8, 0x00, 0xED, 0xE3, 0xE9
  .byte 0x00, 0xDB, 0xD9, 0xE8, 0xFE, 0xDC, 0xD9, 0xE6, 0xD9, 0xAC, 0xFB, 0xCE, 0xBB, 0xCD, 0xDD, 0xE2
  .byte 0xDB, 0xAC, 0x00, 0xD1, 0xDC, 0xD5, 0xE8, 0x00, 0xDD, 0xE7, 0x00, 0xE8, 0xDC, 0xD5, 0xE8, 0xAC
  .byte 0xFF
Text3:
  .byte 0xCE, 0xDC, 0xD9, 0x00, 0xE8, 0xD9, 0xE0, 0xD9, 0xE4, 0xE3, 0xE6, 0xE8, 0xD9, 0xE6, 0x00, 0xE1
  .byte 0xE9, 0xE7, 0xE8, 0xFE, 0xDC, 0xD5, 0xEA, 0xD9, 0x00, 0xD6, 0xD9, 0xD9, 0xE2, 0x00, 0xE3, 0xEA
  .byte 0xD9, 0xE6, 0xE0, 0xE3, 0xD5, 0xD8, 0xD9, 0xD8, 0xB8, 0xFB, 0xCE, 0xDC, 0xDD, 0xE7, 0x00, 0xE4
  .byte 0xE3, 0xE3, 0xE6, 0x00, 0xE8, 0xE6, 0xD5, 0xDD, 0xE2, 0xD9, 0xE6, 0xFE, 0xDD, 0xE7, 0xE2, 0xB3
  .byte 0xE8, 0x00, 0xEB, 0xD9, 0xE0, 0xE0, 0xB8, 0xFB, 0xD1, 0xDD, 0xE8, 0xDC, 0x00, 0xD5, 0xE0, 0xE0
  .byte 0x00, 0xE8, 0xDC, 0xD5, 0xE8, 0xFE, 0xDD, 0xE2, 0xE8, 0xD9, 0xE6, 0xDA, 0xD9, 0xE6, 0xD9, 0xE2
  .byte 0xD7, 0xD9, 0xB8, 0xB8, 0xFB, 0xDD, 0xE8, 0xB3, 0xE7, 0x00, 0xD5, 0xE7, 0x00, 0xDD, 0xDA, 0x00
  .byte 0xE7, 0xE3, 0xE1, 0xD9, 0xE3, 0xE2, 0xD9, 0xFE, 0xE4, 0xE6, 0xD9, 0xE7, 0xE7, 0xD9, 0xD8, 0x00
  .byte 0xD9, 0xEA, 0xD9, 0xE6, 0xED, 0x00, 0xD6, 0xE9, 0xE8, 0xE8, 0xE3, 0xE2, 0xFA, 0xD5, 0xE0, 0xE0
  .byte 0x00, 0xD5, 0xE8, 0x00, 0xE3, 0xE2, 0xD7, 0xD9, 0xAB, 0xFB, 0xBC, 0xE9, 0xE8, 0x00, 0xE8, 0xDC
  .byte 0xD5, 0xE8, 0x00, 0xE1, 0xD9, 0xD5, 0xE2, 0xE7, 0xB8, 0xB8, 0xFF
Movement3:
  .byte face_up, emote_exclamation_mark, delay_16, step_end
Text4:
.byte 0xC3, 0xE8, 0x00, 0xE1, 0xE9, 0xE7, 0xE8, 0x00, 0xDC, 0xD5, 0xEA, 0xD9, 0x00, 0xE4, 0xDD, 0xD7
.byte 0xDF, 0xD9, 0xD8, 0x00, 0xE9, 0xE4, 0xFE, 0xD5, 0x00, 0xD8, 0xDD, 0xDA, 0xDA, 0xD9, 0xE6, 0xD9
.byte 0xE2, 0xE8, 0x00, 0xE7, 0xDD, 0xDB, 0xE2, 0xD5, 0xE0, 0xB8, 0xB8, 0xFB, 0xDA, 0xE6, 0xE3, 0xE1
.byte 0x00, 0xD5, 0xE2, 0xE3, 0xE8, 0xDC, 0xD9, 0xE6, 0x00, 0xE6, 0xD9, 0xDB, 0xDD, 0xE3, 0xE2, 0xAC
.byte 0xFE, 0xB8, 0xB8, 0xC9, 0xE6, 0x00, 0xD5, 0xE2, 0xE3, 0xE8, 0xDC, 0xD9, 0xE6, 0x00, 0xEB, 0xE3
.byte 0xE6, 0xE0, 0xD8, 0xAC, 0xFB, 0xCD, 0xE3, 0x00, 0xEB, 0xDC, 0xD9, 0xE6, 0xD9, 0x00, 0xD8, 0xDD
.byte 0xD8, 0x00, 0xDD, 0xE8, 0x00, 0xE7, 0xD9, 0xE2, 0xD8, 0xFE, 0xBC, 0xDD, 0xE0, 0xE0, 0xAC, 0xFF
Movement4:
  .byte walk_down, walk_down, walk_left, walk_left, walk_left, face_up, delay_16, step_end
Movement5:
  .byte delay_16, delay_16, face_down, step_end
Text5:
.byte 0xC6, 0xD9, 0xD5, 0xDA, 0xB4, 0x00, 0xEB, 0xD9, 0x00, 0xDC, 0xD5, 0xEA, 0xD9, 0x00, 0xE8, 0xE3
.byte 0x00, 0xE6, 0xE9, 0xE2, 0xFE, 0xE8, 0xDC, 0xD9, 0x00, 0xD9, 0xEC, 0xE4, 0xD9, 0xE6, 0xDD, 0xE1
.byte 0xD9, 0xE2, 0xE8, 0x00, 0xD5, 0xDB, 0xD5, 0xDD, 0xE2, 0xB8, 0xFB, 0xC3, 0x00, 0xE8, 0xDC, 0xDD
.byte 0xE2, 0xDF, 0x00, 0xC3, 0x00, 0xD7, 0xD5, 0xE2, 0x00, 0xE6, 0xD9, 0xEA, 0xD9, 0xE6, 0xE7, 0xD9
.byte 0xFE, 0xDD, 0xE8, 0xB4, 0x00, 0xD5, 0xE2, 0xD8, 0x00, 0xE4, 0xE9, 0xE8, 0x00, 0xE8, 0xDC, 0xDD
.byte 0xE2, 0xDB, 0xE7, 0xFA, 0xD6, 0xD5, 0xD7, 0xDF, 0x00, 0xE8, 0xE3, 0x00, 0xE2, 0xE3, 0xE6, 0xE1
.byte 0xD5, 0xE0, 0xB8, 0xFB, 0xB8, 0xB8, 0xC3, 0x00, 0xDC, 0xE3, 0xE4, 0xD9, 0xB8, 0xFB, 0xC4, 0xE9
.byte 0xE7, 0xE8, 0x00, 0xE7, 0xE8, 0xD9, 0xE4, 0x00, 0xDD, 0xE2, 0xE7, 0xDD, 0xD8, 0xD9, 0x00, 0xE8
.byte 0xDC, 0xD9, 0xFE, 0xD8, 0xE3, 0xE3, 0xE6, 0x00, 0xEB, 0xDC, 0xD9, 0xE2, 0x00, 0xDD, 0xE8, 0x00
.byte 0xE7, 0xE8, 0xD5, 0xE6, 0xE8, 0xE7, 0xB8, 0xFF
Movement6:
  .byte walk_up, step_end
Text6:
.byte 0xC9, 0xDC, 0x00, 0xE2, 0xE3, 0xB8, 0xB8, 0xFB, 0xC4, 0xE9, 0xE7, 0xE8, 0x00, 0xDC, 0xD5, 0xE2
.byte 0xDB, 0x00, 0xE3, 0xE2, 0xAB, 0x00, 0xC3, 0x00, 0xD7, 0xD5, 0xE2, 0xFE, 0xE8, 0xE9, 0xE6, 0xE2
.byte 0x00, 0xDD, 0xE8, 0x00, 0xE3, 0xDA, 0xDA, 0xAB, 0xFF
